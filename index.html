<!DOCTYPE html>
<html lang="en">
<head>
  <!-- BUILD: DVA index v12 (PracticeDVAQuiz look) -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <meta name="description" content="Strategic AWS Certified Developer Associate DVA-C02 Exam Trainer - Master timing and pass the exam" />
  <meta name="theme-color" content="#FF9900" media="(prefers-color-scheme: light)" />
  <meta name="theme-color" content="#232F3E" media="(prefers-color-scheme: dark)" />
  <link rel="manifest" href="./manifest.json?v=13" />
  <title>AWS DVA-C02 Strategic Exam Trainer</title>
  <style>
    /* ===== Theme: matches PracticeDVAQuiz feel ===== */
    *{margin:0;padding:0;box-sizing:border-box}
    :root{
      --bg1:#ff8a00; --bg2:#ff6f00;
      --primary:#ff9900; --primary-dark:#ff6600; --chip:#ffe8cc;
      --white:#fff; --light:rgba(255,255,255,.92);
      --success:#2ecc71; --warn:#ffc107; --danger:#e74c3c; --blue:#0073bb;
      --card:rgba(255,255,255,.14); --cardBorder:rgba(255,255,255,.22); --cardHover:rgba(255,255,255,.22);
      --shadow:0 10px 30px rgba(0,0,0,.18)
    }
    body{
      font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Inter,system-ui,sans-serif;
      min-height:100vh;background:linear-gradient(135deg,var(--bg1),var(--bg2));
      display:flex;flex-direction:column;align-items:center;overflow-x:hidden
    }
    .main-header{width:100%;text-align:center;padding:28px 18px 14px}
    .main-header h1{color:var(--white);font-size:2.6rem;font-weight:900;letter-spacing:.3px}
    .main-header .tag{color:var(--light);font-size:.98rem;margin-top:6px}

    .container{width:100%;max-width:1100px;padding:20px}

    /* Hero headline + sub */
    .hero{text-align:center;margin:10px 0 18px}
    .hero h2{color:#fff;font-size:2.0rem;font-weight:900;margin-bottom:6px}
    .hero p{color:var(--light);font-size:1.02rem}

    /* Feature card with chips */
    .features{
      margin:16px auto;background:var(--card);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);
      border:1px solid var(--cardBorder);border-radius:18px;box-shadow:var(--shadow);padding:18px 18px 16px
    }
    .features h3{color:#fff;font-size:1.2rem;font-weight:900;display:flex;gap:8px;align-items:center;justify-content:center;margin-bottom:10px}
    .features .sub{color:var(--light);text-align:center;margin-bottom:8px}
    .chips{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:10px;margin-top:8px}
    .chip{background:var(--chip);border-radius:12px;padding:10px 12px;font-weight:700;color:#8a4b00;display:flex;align-items:center;gap:8px;justify-content:center}

    /* Mode cards */
    .modes{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px;margin:22px 0}
    .card{
      background:var(--card);border:1px solid var(--cardBorder);backdrop-filter:blur(10px);
      border-radius:18px;box-shadow:var(--shadow);padding:22px;transition:transform .15s ease,background .15s
    }
    .card:hover{transform:translateY(-6px);background:var(--cardHover)}
    .card h4{color:#fff;font-size:1.25rem;font-weight:900;margin-bottom:6px}
    .card p{color:var(--light);font-size:.95rem;margin-bottom:8px}
    .bullets{margin-top:6px}
    .bullets li{list-style:none;color:var(--light);font-size:.92rem;padding:4px 0}
    .bullets li:before{content:'‚úì';margin-right:8px;color:#fff;font-weight:900}

    /* Timers strip */
    .timers{display:none;gap:14px;justify-content:center;margin:8px auto 0;flex-wrap:wrap}
    .tbox{min-width:170px;background:rgba(255,255,255,.18);border:1px solid rgba(255,255,255,.28);
      border-radius:14px;padding:12px 14px;text-align:center;box-shadow:0 6px 20px rgba(0,0,0,.15)}
    .tlabel{color:var(--light);font-size:.78rem;margin-bottom:6px;text-transform:uppercase;letter-spacing:.5px}
    .tval{color:#fff;font-size:1.7rem;font-weight:900}
    .pace{margin-top:6px;padding:4px 10px;border-radius:20px;color:#fff;font-weight:900;font-size:.78rem}
    .pace.ok{background:var(--success)} .pace.warn{background:var(--warn)} .pace.bad{background:var(--danger)}

    /* Question card */
    .qwrap{
      display:none;background:#fff;border-radius:20px;padding:26px;margin:18px auto;max-width:1000px;color:#333;box-shadow:var(--shadow)
    }
    .qhdr{display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap;margin-bottom:12px}
    .badge{padding:6px 12px;border-radius:16px;font-size:.85rem;font-weight:800;color:#fff}
    .bdomain{background:var(--primary)} .beasy{background:var(--success)} .bmed{background:#fd7e14} .bhard{background:var(--danger)}
    .scenario{background:#fff5f5;border-left:4px solid var(--primary);padding:12px;border-radius:10px;margin:8px 0 12px;color:#444}
    .qtext{font-size:1.08rem;font-weight:900;margin:6px 0 12px;color:#232F3E}

    .options{display:flex;flex-direction:column;gap:10px}
    .opt{background:#fff;border:2px solid #e6e6e6;border-radius:10px;padding:12px;cursor:pointer;display:flex;gap:10px;align-items:flex-start;transition:all .15s}
    .opt:hover{border-color:#ffb84d;transform:translateX(3px);box-shadow:0 4px 12px rgba(0,0,0,.08)}
    .opt.selected{background:#FFF3E0;border-color:#ff9900}
    .opt.correct{background:#E8F5E9;border-color:#2ecc71}
    .opt.incorrect{background:#FFEBEE;border-color:#e74c3c}
    .letter{min-width:28px;height:28px;border-radius:50%;background:var(--blue);color:#fff;display:flex;align-items:center;justify-content:center;font-weight:900}

    .explain{display:none;margin-top:14px;background:linear-gradient(135deg,#f0f8ff,#f5faff);border:1px solid #d1e7ff;border-radius:12px;padding:16px}
    .controls{display:flex;gap:10px;margin-top:14px}
    .btn{flex:1;padding:12px 18px;border:none;border-radius:24px;color:#fff;font-weight:900;cursor:pointer;letter-spacing:.4px;text-transform:uppercase}
    .primary{background:linear-gradient(135deg,#ff9900,#ff6600)}
    .secondary{background:linear-gradient(135deg,#6c757d,#5a6268)}
    @media (max-width:768px){.controls{flex-direction:column}.btn{width:100%}}

    /* Results */
    .results{display:none;background:#fff;border-radius:20px;padding:26px;margin:18px auto;max-width:1000px;box-shadow:var(--shadow)}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:14px;margin:14px 0}
    .stat{background:#f8f9fa;border-radius:12px;padding:14px;text-align:center}
    .big{font-size:1.7rem;font-weight:900;color:var(--blue)}
  </style>
</head>
<body>
  <div class="main-header">
    <h1>üöÄ AWS DVA-C02 Strategic Exam Trainer</h1>
    <div class="tag">Master exam timing and strategy with 500+ realistic developer scenarios ‚Ä¢ Turn 72% fails into 85+ passes</div>
  </div>

  <div class="container">
    <div class="hero">
      <h2>Strategic Developer Exam Training</h2>
      <p>Failed by 2 questions? Time management, not knowledge, was the issue. Master the strategy.</p>
    </div>

    <div class="features">
      <h3>üéØ Professional Question Bank</h3>
      <div class="sub"><strong>500+ Questions</strong> covering all DVA-C02 services per official exam guide</div>
      <div class="chips">
        <div class="chip">üîß 160+ Development questions</div>
        <div class="chip">üîê 130+ Security scenarios</div>
        <div class="chip">üöÄ 120+ Deployment cases</div>
        <div class="chip">üß© 90+ Troubleshooting</div>
        <div class="chip">üîÑ Smart question rotation</div>
        <div class="chip">üß† Anti-memorization system</div>
      </div>
    </div>

    <div class="modes" id="modeSelection">
      <div class="card" onclick="startMode('triage')">
        <h4>‚ö° Triage Training</h4>
        <p>Learn to identify quick wins vs time sinks in under 30 seconds.</p>
        <ul class="bullets">
          <li>Question difficulty recognition</li>
          <li>30-second decision drills</li>
          <li>Strategic skip/answer patterns</li>
        </ul>
      </div>
      <div class="card" onclick="startMode('speed')">
        <h4>üî• Speed Rounds</h4>
        <p>90-second maximum per question ‚Äì build exam pace muscle memory.</p>
        <ul class="bullets">
          <li>Hard 90-second time limits</li>
          <li>Automatic progression</li>
          <li>Pace analytics</li>
        </ul>
      </div>
      <div class="card" onclick="startMode('exam')">
        <h4>üéØ Full Exam Simulation</h4>
        <p>Real 130-minute, 65-question exam with strategic coaching.</p>
        <ul class="bullets">
          <li>Authentic time pressure</li>
          <li>Real exam difficulty</li>
          <li>Strategic alerts & guidance</li>
        </ul>
      </div>
      <div class="card" onclick="startMode('strategic')">
        <h4>üß† Strategic Practice</h4>
        <p>Learn mark/skip/return workflow with complex scenarios.</p>
        <ul class="bullets">
          <li>Flag & review system</li>
          <li>Flexible timing</li>
          <li>Decision tree training</li>
        </ul>
      </div>
    </div>

    <!-- Timers strip -->
    <div class="timers" id="timerSection">
      <div class="tbox">
        <div class="tlabel">Global Timer</div>
        <div class="tval" id="globalTimer">00:00</div>
      </div>
      <div class="tbox">
        <div class="tlabel">Question Time</div>
        <div class="tval" id="questionTimer">00:00</div>
      </div>
      <div class="tbox">
        <div class="tlabel">Pace Status</div>
        <div class="tval" id="paceValue">Œî +0m 00s</div>
        <div class="pace ok" id="paceIndicator">ON TRACK</div>
      </div>
    </div>

    <!-- Question card -->
    <div class="qwrap" id="questionContainer">
      <div class="qhdr">
        <div>
          <span class="badge bdomain" id="domainBadge">Domain</span>
          <span class="badge bmed" id="difficultyBadge">Medium</span>
          <span class="badge" id="questionNumber">Q1 of N</span>
        </div>
        <div style="display:flex;gap:8px">
          <button class="btn secondary" style="flex:none" onclick="toggleFlag()">üö© Flag</button>
          <button class="btn primary"  style="flex:none" onclick="skipQuestion()">‚è≠Ô∏è Skip</button>
        </div>
      </div>

      <div class="scenario" id="scenario"></div>
      <div class="qtext" id="questionText"></div>
      <div class="options" id="options"></div>

      <div class="explain" id="explanation">
        <div><strong>‚úÖ Correct:</strong> <span id="correctExplanation"></span></div>
        <div style="margin-top:8px"><strong>üí° Tip:</strong> <span id="strategyTip"></span></div>
      </div>

      <div class="controls">
        <button class="btn secondary" onclick="previousQuestion()">Previous</button>
        <button class="btn primary" id="submitBtn" onclick="submitAnswer()">Submit</button>
        <button class="btn primary" id="nextBtn" style="display:none" onclick="nextQuestion()">Next</button>
      </div>
    </div>

    <!-- Results card -->
    <div class="results" id="resultsContainer">
      <h2>üìä Performance Analysis</h2>
      <div class="grid">
        <div class="stat"><div>Score</div><div class="big" id="scoreText">0%</div></div>
        <div class="stat"><div>Correct</div><div class="big" id="correctCount">0/0</div></div>
        <div class="stat"><div>Time Used</div><div class="big" id="timeUsed">00:00</div></div>
        <div class="stat"><div>Flagged</div><div class="big" id="flaggedCount">0</div></div>
      </div>
      <div class="controls">
        <button class="btn primary" onclick="reviewAnswers()">Detailed Review</button>
        <button class="btn secondary" onclick="resetQuiz()">Take Another Exam</button>
      </div>
    </div>
  </div>

  <!-- Extension noise guard (keeps UI clean) -->
  <script>try{['ethereum','tronWeb','solana','walletRouter'].forEach(p=>Object.defineProperty(window,p,{get:()=>undefined,set:()=>{},configurable:false}))}catch(e){}</script>

  <!-- Load your bank -->
  <script src="./questions.js?v=12"></script>
  <!-- Bridge: if bank was defined as 'const questionBank', lift it -->
  <script>if(typeof window.questionBank==="undefined"&&typeof questionBank!=="undefined"){window.questionBank=questionBank}</script>

  <script>
    /* ===== Mode config ===== */
    const MODES = {
      triage:    { label:'Triage',     total:10, timePerQ:30,  perQWarn:30,  globalMin:null,  autoAdvance:true,  filter:q=>(q.difficulty||'').toLowerCase()!=='easy' },
      speed:     { label:'Speed',      total:40, timePerQ:90,  perQWarn:90,  globalMin:null,  autoAdvance:true,  filter:null },
      exam:      { label:'Full Exam',  total:65, timePerQ:null, perQWarn:90, globalMin:130,   autoAdvance:false, filter:null },
      strategic: { label:'Strategic',  total:30, timePerQ:null, perQWarn:null,globalMin:null, autoAdvance:false, filter:null }
    };

    /* ===== State & helpers ===== */
    const state = {
      mode:null, questions:[], index:0, answers:[], correctCount:0,
      flagged:new Set(), skipped:new Set(), startedAt:null, qStartedAt:null, perQTimes:[],
      timers:{global:null, perQ:null}
    };
    const $ = id => document.getElementById(id);
    const pad2 = n => String(n).padStart(2,'0');
    const fmt = s => `${pad2((s/60)|0)}:${pad2(s%60)}`;
    const dClock = s => { s=Math.abs(s); return `${(s/60)|0}m ${pad2(s%60)}` };
    function sample(arr,n){ if(n>=arr.length) return [...arr].sort(()=>Math.random()-0.5); const out=[],u=new Set(); while(out.length<n){const i=(Math.random()*arr.length)|0; if(!u.has(i)){u.add(i); out.push(arr[i])}} return out }
    function overallDelta(cfg, perQElapsed){
      const base = cfg.timePerQ || (cfg.globalMin ? Math.round((cfg.globalMin*60)/state.questions.length) : (cfg.perQWarn||90));
      const answered = state.answers.filter(a=>a!==null).length;
      const expected = answered*base + Math.min(perQElapsed, base);
      const actual = ((Date.now()-state.startedAt)/1000)|0;
      return actual - expected; // + behind, - ahead
    }

    /* ===== Engine ===== */
    function startMode(name){
      if(!Array.isArray(window.questionBank)||!window.questionBank.length){ alert('Questions not loaded.'); return; }
      const cfg = MODES[name]; state.mode=name;
      const pool = cfg.filter ? window.questionBank.filter(cfg.filter) : window.questionBank;
      state.questions = sample(pool, cfg.total);
      state.index=0; state.answers=new Array(state.questions.length).fill(null);
      state.correctCount=0; state.flagged.clear(); state.skipped.clear();
      state.perQTimes=new Array(state.questions.length).fill(0);
      state.startedAt=Date.now();

      $('modeSelection').style.display='none';
      $('timerSection').style.display='flex';
      $('questionContainer').style.display='block';
      $('resultsContainer').style.display='none';
      $('explanation').style.display='none';

      clearInterval(state.timers.global); clearInterval(state.timers.perQ);
      if(cfg.globalMin){
        const end = state.startedAt + cfg.globalMin*60*1000;
        state.timers.global=setInterval(()=>{const left=Math.max(0,((end-Date.now())/1000)|0); $('globalTimer').textContent=fmt(left); if(left<=0){clearInterval(state.timers.global); finish();}},250);
      }else{
        state.timers.global=setInterval(()=>{const el=((Date.now()-state.startedAt)/1000)|0; $('globalTimer').textContent=fmt(el)},250);
      }
      render(true);
    }

    function startPerQ(){
      const cfg = MODES[state.mode];
      clearInterval(state.timers.perQ);
      state.qStartedAt=Date.now();
      state.timers.perQ=setInterval(()=>{
        const elapsed=((Date.now()-state.qStartedAt)/1000)|0;
        $('questionTimer').textContent=fmt(elapsed);

        if(cfg.timePerQ){
          const left = cfg.timePerQ - elapsed;
          if(left<=0){
            recordQTime(); state.skipped.add(state.index); clearInterval(state.timers.perQ);
            if(cfg.autoAdvance){ next(); } else { $('submitBtn').style.display='none'; $('nextBtn').style.display='block'; }
            return;
          }
        }
        const delta=overallDelta(cfg,elapsed), ind=$('paceIndicator'), val=$('paceValue');
        if(cfg.perQWarn && elapsed>cfg.perQWarn){
          ind.className='pace bad'; ind.textContent=`OVER ${cfg.perQWarn}s`;
          val.textContent=`+${elapsed-cfg.perQWarn}s | Œî ${delta>=0?'+':'-'}${dClock(delta)}`;
        }else{
          if(delta>15){ ind.className='pace warn'; ind.textContent='BEHIND'; }
          else if(delta<-15){ ind.className='pace ok'; ind.textContent='AHEAD'; }
          else{ ind.className='pace ok'; ind.textContent='ON TRACK'; }
          val.textContent=`Œî ${delta>=0?'+':'-'}${dClock(delta)}`;
        }
      },1000);
    }

    function recordQTime(){ const s=((Date.now()-state.qStartedAt)/1000)|0; state.perQTimes[state.index]+=s; }

    function render(first=false){
      const q=state.questions[state.index]; if(!q){ finish(); return; }
      $('domainBadge').textContent=q.domain||'Domain';
      const diff=(q.difficulty||'medium').toLowerCase(), db=$('difficultyBadge');
      db.textContent=diff[0].toUpperCase()+diff.slice(1);
      db.className='badge '+(diff==='easy'?'beasy':diff==='hard'?'bhard':'bmed');
      $('questionNumber').textContent=`Q${state.index+1} of ${state.questions.length}`;
      $('scenario').textContent=q.scenario||''; $('questionText').textContent=q.question||'';

      const wrap=$('options'); wrap.innerHTML=''; const letters='ABCDEFGHIJKLMNOPQRSTUVWXYZ';
      (q.options||[]).forEach((opt,i)=>{ const d=document.createElement('div'); d.className='opt'; d.onclick=()=>select(i); d.innerHTML=`<div class="letter">${letters[i]}</div><div>${opt}</div>`; if(state.answers[state.index]===i) d.classList.add('selected'); wrap.appendChild(d); });

      $('explanation').style.display='none'; $('submitBtn').style.display='block'; $('nextBtn').style.display='none';
      startPerQ();
      if(first){ $('paceIndicator').className='pace ok'; $('paceIndicator').textContent='ON TRACK'; $('paceValue').textContent='Œî +0m 00s'; }
    }

    function select(i){ state.answers[state.index]=i; [...$('options').children].forEach((el,idx)=>el.classList.toggle('selected',idx===i)); }

    function submitAnswer(){
      const q=state.questions[state.index]; if(state.answers[state.index]==null){ alert('Select an answer or Skip.'); return; }
      recordQTime(); clearInterval(state.timers.perQ);
      const chosen=state.answers[state.index];
      [...$('options').children].forEach((el,idx)=>{ el.classList.remove('selected'); el.classList.add(idx===q.correct?'correct':(idx===chosen?'incorrect':'')); });
      if(chosen===q.correct) state.correctCount++;
      $('correctExplanation').textContent=(q.explanation&&(q.explanation.correct||q.explanation))||''; $('strategyTip').textContent=(q.explanation&&(q.explanation.examStrategy||''))||'';
      $('explanation').style.display='block'; $('submitBtn').style.display='none'; $('nextBtn').style.display='block';
    }

    function next(){ clearInterval(state.timers.perQ); if(state.index<state.questions.length-1){ state.index++; render(); } else { finish(); } }
    function previous(){ clearInterval(state.timers.perQ); if(state.index>0){ state.index--; render(); } }
    function skipQuestion(){ recordQTime(); state.skipped.add(state.index); next(); }
    function toggleFlag(){ state.flagged.has(state.index)?state.flagged.delete(state.index):state.flagged.add(state.index); }

    function finish(){
      clearInterval(state.timers.global); clearInterval(state.timers.perQ);
      $('questionContainer').style.display='none'; $('resultsContainer').style.display='block';
      const total=state.questions.length, pct=Math.round((state.correctCount/total)*100);
      $('scoreText').textContent=`${pct}%`; $('correctCount').textContent=`${state.correctCount}/${total}`;
      $('timeUsed').textContent=fmt(((Date.now()-state.startedAt)/1000)|0); $('flaggedCount').textContent=state.flagged.size;
    }

    function resetQuiz(){
      clearInterval(state.timers.global); clearInterval(state.timers.perQ);
      state.mode=null; state.questions=[]; state.index=0; state.answers=[]; state.flagged.clear(); state.skipped.clear();
      $('resultsContainer').style.display='none'; $('questionContainer').style.display='none'; $('timerSection').style.display='none';
      $('modeSelection').style.display='grid'; $('globalTimer').textContent='00:00'; $('questionTimer').textContent='00:00';
      $('paceIndicator').className='pace ok'; $('paceIndicator').textContent='ON TRACK'; $('paceValue').textContent='Œî +0m 00s'; window.scrollTo(0,0);
    }

    // Public API
    window.startMode=startMode; window.previousQuestion=previous; window.submitAnswer=submitAnswer;
    window.nextQuestion=next; window.skipQuestion=skipQuestion; window.toggleFlag=toggleFlag; window.resetQuiz=resetQuiz;
    window.reviewAnswers=()=>alert('Detailed review coming next build.');
  </script>
  <script>
  // === DVA install module (robust) ===
  (function () {
    const banner = document.getElementById('installBanner'); // if you use a banner
    let deferredPrompt = null;

    // Hide banner helper
    function hideInstall() {
      if (banner) banner.style.display = 'none';
    }
    // Show banner helper
    function showInstall() {
      if (banner) banner.style.display = 'flex';
    }

    // Already running as an installed app? hide UI
    const isStandalone =
      window.matchMedia('(display-mode: standalone)').matches ||
      window.navigator.standalone === true;
    if (isStandalone) hideInstall();

    // If you have your own "Install App" button, wire it here:
    window.installPWA = async function () {
      // If Chrome gave us the event: use it
      if (deferredPrompt) {
        deferredPrompt.prompt();
        const choice = await deferredPrompt.userChoice.catch(() => ({}));
        deferredPrompt = null;
        hideInstall();
        return;
      }
      // Fallback hints for other browsers:
      // - iOS Safari: Share ‚Üí Add to Home Screen
      // - Desktop Chrome/Edge: Use browser menu ‚Üí "Install app"
      alert(
        'If no prompt appears:\n' +
        '‚Ä¢ iOS Safari: Share ‚Üí Add to Home Screen\n' +
        '‚Ä¢ Desktop Chrome/Edge: Browser menu ‚Üí ‚ÄúInstall app‚Äù'
      );
    };

    // Chrome/Edge: event fires when install criteria are met
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();        // prevent auto-mini-infobar
      deferredPrompt = e;        // stash for our button
      showInstall();             // reveal your banner/button
      console.log('[PWA] beforeinstallprompt fired');
    });

    // When installed, hide install UI
    window.addEventListener('appinstalled', () => {
      console.log('[PWA] App installed');
      hideInstall();
      deferredPrompt = null;
      localStorage.setItem('dva_installed', '1');
    });

    // Optionally, re-show after some time if user dismissed your banner
    const dismissedAt = +localStorage.getItem('dva_install_dismissed') || 0;
    document.getElementById('installBanner')?.querySelector('.secondary')
      ?.addEventListener('click', () => {
        hideInstall();
        localStorage.setItem('dva_install_dismissed', Date.now().toString());
      });

    // If your page loads and the event didn't fire yet, keep banner hidden.
    // It will auto-show when the event fires (if criteria are met).
  })();
</script>
</body>
</html>
